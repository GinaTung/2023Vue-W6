import{_ as b,o,c as d,d as t,F as u,f as g,g as m,t as n,n as y,b as p,h as C,v as f}from"./index-394ba2f5.js";const{VITE_APP_URL:h,VITE_APP_PATH:_}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"yuling202202",BASE_URL:"/2023Vue-W6",MODE:"production",DEV:!1,PROD:!0},v={data(){return{products:[],productId:"",cart:"",loadingItem:""}},methods:{getCarts(){this.$http.get(`${h}/api/${_}/cart`).then(s=>{console.log("購物車:",s.data),this.cart=s.data.data}).catch(s=>{console.log(s.data.message)})},updataCartItem(s){const a={product_id:s.product.id,qty:s.qty};this.loadingItem=s.id,this.$http.put(`${h}/api/${_}/cart/${s.id}`,{data:a}).then(c=>{console.log("更新購物車:",c.data),this.getCarts(),this.loadingItem=""}).catch(c=>{console.log(c.data.message)})},deleteItem(s){this.loadingItem=s.id,this.$http.delete(`${h}/api/${_}/cart/${s.id}`).then(a=>{console.log("刪除購物車:",a.data),alert(`刪除購物車商品:${s.product.title}`),this.getCarts(),this.loadingItem=""}).catch(a=>{console.log(a.data.message)})},deleteAllCarts(){this.$http.delete(`${h}/api/${_}/carts`).then(s=>{console.log("清除購物車全部商品:",s.data.message),alert("清除購物車全部商品已完成"),this.getCarts()}).catch(s=>{alert(s.data.message)})}},mounted(){this.getCarts()}},k=t("h2",null,"This is 購物車頁面",-1),I={class:"table align-middle"},x=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),$={style:{width:"200px"}},V={key:0,class:"h5"},P={key:1},A={class:"h6"},T={class:"h5"},E={class:"btn-group btn-group-sm"},U=["onClick"],D=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),q=["onClick"],w=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),B={class:"text-end"},L={class:"table align-middle"},R=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),S={type:"button",class:"btn btn-outline-danger btn-sm"},M=["onClick","disabled"],N={class:"input-group input-group-sm"},z=["onUpdate:modelValue","disabled","onChange"],F=["value"],H={class:"text-end"},O=t("td",{colspan:"3",class:"text-end"},"總計",-1),W={class:"text-end"},j=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),G={class:"text-end text-success"};function J(s,a,c,K,i,r){return o(),d(u,null,[k,t("table",I,[x,t("tbody",null,[(o(!0),d(u,null,g(i.products,e=>(o(),d("tr",{key:e.id},[t("td",$,[t("div",{style:y([{height:"100px background-size: cover background-position: center"},{backgroundImage:`url('${e.imageUrl}')`}])},null,4)]),t("td",null,n(e.title),1),t("td",null,[e.price===e.origin_price?(o(),d("div",V,n(e.price)+" 元",1)):(o(),d("div",P,[t("del",A,"原價 "+n(e.origin_price)+" 元",1),t("div",T,"現在只要 "+n(e.price)+" 元",1)]))]),t("td",null,[t("div",E,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:l=>s.openModal(e.id)},[D,p(" 查看更多 ")],8,U),t("button",{type:"button",class:"btn btn-outline-danger",onClick:l=>s.addToCart(e.id)},[w,p(" 加到購物車 ")],8,q)])])]))),128))])]),t("div",B,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=(...e)=>r.deleteAllCarts&&r.deleteAllCarts(...e))},"清空購物車")]),t("table",L,[R,t("tbody",null,[i.cart.carts?(o(!0),d(u,{key:0},g(i.cart.carts,e=>(o(),d("tr",{key:e.id},[t("td",null,[t("button",S,[t("i",{class:"fas fa-spinner fa-pulse",onClick:l=>r.deleteItem(e),disabled:e.id===i.loadingItem},null,8,M),p(" x ")])]),t("td",null,n(e.product.title)+" ",1),t("td",null,[t("div",N,[C(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":l=>e.qty=l,disabled:e.id===i.loadingItem,onChange:l=>r.updataCartItem(e)},[(o(),d(u,null,g(20,l=>t("option",{value:l,key:`${l}12345`},n(l),9,F)),64))],40,z),[[f,e.qty]])])]),t("td",H,n(e.total),1)]))),128)):m("",!0)]),t("tfoot",null,[t("tr",null,[O,t("td",W,n(i.cart.total),1)]),t("tr",null,[j,t("td",G,n(i.cart.final_total),1)])])])],64)}const X=b(v,[["render",J]]);export{X as default};
